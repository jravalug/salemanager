{% extends "base.html" %}
{% block content %}
  <section class="bg-white dark:bg-gray-900 py-12">
    <div class="mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
      <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-8">
        Reporte Categorizado de Ventas
      </h1>

      <!-- Formulario de selección de mes -->
      <form method="POST" class="my-8">
        <div class="flex items-center space-x-4">
          <input
            type="month"
            name="month"
            required
            class="px-4 py-2 border border-gray-300 rounded-lg dark:border-gray-700 dark:bg-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          />
          <button
            type="submit"
            class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 transition-colors"
          >
            Generar Reporte
          </button>
        </div>
      </form>

      <!-- Contenido del reporte -->
      {% if categorized_sales %}
        <div class="space-y-8">
          {%
            for category in [
                "1-2 productos",
                "3-5 productos",
                "6-10 productos",
                "11-15 productos",
                "16-20 productos",
                "21+ productos",
            ]
          %}
            {% if categorized_sales[category] %}
              <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg shadow-sm">
                <h2 class="text-2xl font-semibold text-gray-900 dark:text-white mb-4">
                  {{ category }}
                </h2>
                <table class="w-full text-left text-sm text-gray-700 dark:text-gray-300">
                  <thead class="bg-gray-100 dark:bg-gray-700">
                    <tr>
                      <th class="px-4 py-3">Fecha</th>
                      <th class="px-4 py-3">Número de Venta</th>
                      <th class="px-4 py-3 text-center">Cantidad de Productos</th>
                      <th class="px-4 py-3">Importe Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for sale in categorized_sales[category] %}
                      <tr class="border-b dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <td class="px-4 py-3">{{ sale.date }}</td>
                        <td class="px-4 py-3">
                          <a
                            href="{{ url_for('sale.details', business_id=business.id, sale_id=sale.sale_id) }}"
                            class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors"
                          >
                            {{ sale.sale_number }}
                          </a>
                        </td>
                        <td class="px-4 py-3 text-center">{{ sale.total_products }}</td>
                        <td class="px-4 py-3">{{ sale.total_income | currency }}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </section>
{% endblock %}
